# Kafka Broker Configuration for Local Development

# Basic Broker Settings
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
# Define separate internal and external listeners. Internal is used by other containers on the Docker network,
# external is used by host clients via the mapped host port 9094.
KAFKA_LISTENERS=INTERNAL://0.0.0.0:9092,EXTERNAL://0.0.0.0:9094
# Changed EXTERNAL advertised listener to use localhost:9094 (not kafka-broker1:9092)
# This allows host clients to connect properly
KAFKA_ADVERTISED_LISTENERS=INTERNAL://kafka-broker1:9092,EXTERNAL://localhost:9094
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT
KAFKA_INTER_BROKER_LISTENER_NAME=INTERNAL

# Topic Configuration
KAFKA_AUTO_CREATE_TOPICS_ENABLE=false
KAFKA_DELETE_TOPIC_ENABLE=true
KAFKA_NUM_PARTITIONS=4
KAFKA_DEFAULT_REPLICATION_FACTOR=1

# Performance Tuning for Local Development
KAFKA_LOG_RETENTION_HOURS=24
KAFKA_LOG_SEGMENT_BYTES=1073741824
KAFKA_LOG_RETENTION_CHECK_INTERVAL_MS=300000
KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS=0

# Transaction Configuration
KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1

# Memory and Performance Settings
KAFKA_HEAP_OPTS=-Xmx512M -Xms512M
KAFKA_JVM_PERFORMANCE_OPTS=-XX:MetaspaceSize=96m -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:G1HeapRegionSize=16M -XX:MinMetaspaceFreeRatio=50 -XX:MaxMetaspaceFreeRatio=80

# Socket Settings
KAFKA_SOCKET_SEND_BUFFER_BYTES=102400
KAFKA_SOCKET_RECEIVE_BUFFER_BYTES=102400
KAFKA_SOCKET_REQUEST_MAX_BYTES=104857600

# Log Settings
KAFKA_LOG4J_ROOT_LOGLEVEL=INFO
KAFKA_LOG4J_LOGGERS=kafka.controller=INFO,kafka.producer.async.DefaultEventHandler=INFO,state.change.logger=INFO

# Replication Settings (for single broker)
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1
KAFKA_CONFLUENT_TOPIC_REPLICATION_FACTOR=1