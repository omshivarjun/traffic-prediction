# Spark Configuration for Traffic Prediction Streaming - Task 9
# =============================================================
# This configuration file optimizes Spark for real-time traffic data processing
# with Kafka integration and multi-sink output capabilities.

# Application Configuration
spark.app.name                     TrafficPredictionStreaming
spark.master                       local[*]

# Streaming Configuration
spark.sql.streaming.checkpointLocation          hdfs://localhost:9000/traffic/checkpoints
spark.sql.streaming.stateStore.maintenanceInterval  30s
spark.sql.streaming.metricsEnabled              true
spark.sql.streaming.ui.enabled                  true
spark.streaming.stopGracefullyOnShutdown        true

# Kafka Configuration
spark.sql.streaming.kafka.useDeprecatedOffsetFetching  false
spark.kafka.consumer.cache.capacity             64
spark.kafka.producer.cache.timeout              10m

# Memory Configuration
spark.executor.memory              2g
spark.driver.memory                1g
spark.executor.cores               2
spark.sql.execution.arrow.pyspark.enabled  true

# Serialization
spark.serializer                   org.apache.spark.serializer.KryoSerializer
spark.kryoserializer.buffer.max    512m

# Dynamic Allocation
spark.dynamicAllocation.enabled    true
spark.dynamicAllocation.minExecutors   1
spark.dynamicAllocation.maxExecutors   4
spark.dynamicAllocation.initialExecutors  2

# SQL Optimization
spark.sql.adaptive.enabled                    true
spark.sql.adaptive.coalescePartitions.enabled  true
spark.sql.adaptive.skewJoin.enabled           true
spark.sql.cbo.enabled                         true

# HDFS Configuration
spark.sql.warehouse.dir            hdfs://localhost:9000/spark-warehouse
spark.hadoop.fs.defaultFS          hdfs://localhost:9000

# UI Configuration
spark.ui.enabled                   true
spark.ui.port                      4040
spark.history.ui.port              18080

# Logging
spark.eventLog.enabled             true
spark.eventLog.dir                 hdfs://localhost:9000/spark-logs
spark.history.fs.logDirectory      hdfs://localhost:9000/spark-logs

# Metrics
spark.metrics.conf.driver.source.jvm.class    org.apache.spark.metrics.source.JvmSource
spark.metrics.conf.executor.source.jvm.class  org.apache.spark.metrics.source.JvmSource

# Network Configuration
spark.network.timeout              800s
spark.sql.broadcastTimeout         36000

# Checkpoint Configuration
spark.sql.streaming.checkpointLocation.minBatchesToRetain  10